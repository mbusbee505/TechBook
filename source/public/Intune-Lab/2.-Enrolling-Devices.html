<!DOCTYPE html>
<html lang="en"><head><title>2. Enrolling Devices</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains Mono&amp;family=JetBrains Mono:wght@400;700&amp;family=JetBrains Mono:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="2. Enrolling Devices"/><meta property="og:description" content="Getting the Hardware Hash In a real world scenario hardware hashes for each device would be provided to the organization by the device manufacturer, but since I can‚Äôt do that I had to ..."/><meta property="og:image" content="https://busbeetech.com/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/favicon.ico"/><link rel="shortcut icon" href="../static/favicon.ico"/><meta name="description" content="Getting the Hardware Hash In a real world scenario hardware hashes for each device would be provided to the organization by the device manufacturer, but since I can‚Äôt do that I had to ..."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Intune-Lab/2.-Enrolling-Devices"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="..">BusbeeTech üêù</a></h2><div class="spacer mobile-only"></div><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;Intune-Lab&quot;,&quot;collapsed&quot;:true}]" aria-controls="explorer-content" aria-expanded="false"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Intune-Lab"><button class="folder-button"><span class="folder-title">Intune Lab</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Intune-Lab"><li><a href="../Intune-Lab/0.-Project-Introduction" data-for="Intune-Lab/0.-Project-Introduction">0. Project Introduction</a></li><li><a href="../Intune-Lab/1.-Setting-Up-The-Lab" data-for="Intune-Lab/1.-Setting-Up-The-Lab">1. Setting Up The Lab</a></li><li><a href="../Intune-Lab/2.-Enrolling-Devices" data-for="Intune-Lab/2.-Enrolling-Devices">2. Enrolling Devices</a></li><li><a href="../Intune-Lab/3.-Polishing-OOBE" data-for="Intune-Lab/3.-Polishing-OOBE">3. Polishing OOBE</a></li><li><a href="../Intune-Lab/4.-Installing-Apps" data-for="Intune-Lab/4.-Installing-Apps">4. Installing Apps</a></li><li><a href="../Intune-Lab/5.-Creating-Update-Rings" data-for="Intune-Lab/5.-Creating-Update-Rings">5. Creating Update Rings</a></li><li><a href="../Intune-Lab/6.-Securing-Devices" data-for="Intune-Lab/6.-Securing-Devices">6. Securing Devices</a></li></ul></div></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href="../Intune-Lab/">Intune Lab</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href>2. Enrolling Devices</a></div></nav><h1 class="article-title">2. Enrolling Devices</h1><p show-comma="true" class="content-meta"><span>Sep 20, 2025</span><span>4 min read</span></p></div></div><article class="popover-hint"><h1 id="getting-the-hardware-hash">Getting the Hardware Hash<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#getting-the-hardware-hash" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>In a real world scenario hardware hashes for each device would be provided to the organization by the device manufacturer, but since I can‚Äôt do that I had to fake it a bit.</p>
<p>I created a new Windows 11 VM and when it got to the select region screen I pressed Shift+F10 to open command prompt then ran the command <code>powershell</code> to get to open a new PowerShell session.</p>
<p>The commands below do the following things:</p>
<ul>
<li>Installs Microsoft Graph</li>
<li>Connects to Microsoft Graph using the TenantID provided</li>
<li>Sets Execution Policy to Bypass</li>
<li>Installs Windows Autopilot Info module</li>
<li>Generates the device hardware hash and uploads it to the tenant</li>
</ul>
<pre><code>Set-ExecutionPolicy -Scope Process Bypass -Force
Install-Module Microsoft.Graph -Scope CurrentUser
Connect-MgGraph -Scopes &quot;Group.ReadWrite.All&quot; -TenantID &quot;&lt;Your Tenant ID>&quot;
Install-Script -Name Get-WindowsAutopilotInfo -Force
Get-WindowsAutopilotInfo -Online
</code></pre>
<p><img src="../Intune-Lab/attachments/2.-Enrolling-Devices-1.png" width="auto" height="auto" alt/></p>
<p>To confirm this was successful you can go to Intune > Devices > Enrollment > Windows Autopilot > Devices</p>
<p><img src="../Intune-Lab/attachments/2.-Enrolling-Devices-2.png" width="auto" height="auto" alt/></p>
<p>Here I can see my VM running on VMware ‚Äúhardware‚Äù. With this in place I‚Äôm ready to move on.</p>
<h1 id="creating-autopilot-device-group">Creating Autopilot Device Group<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#creating-autopilot-device-group" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>I created a Dynamic Security group called All-Registered-Autopilot that will grab all devices registered to Autopilot. This will be the group I assign the Deployment Profile and Enrollment Status Page to.</p>
<p>Intune > Groups > New Group</p>
<ul>
<li><strong>Name</strong>: All-Registered-Autopilot</li>
<li><strong>Description</strong>: All Devices registered to Autopilot</li>
<li><strong>Membership Type</strong>: Dynamic Device</li>
</ul>
<p>Edit Dynamic Query > Configuration Rules</p>
<pre><code>(device.devicePhysicalIds -any (_ -startsWith &quot;[ZTDId]&quot;))
</code></pre>
<h1 id="creating-the-deployment-profile">Creating The Deployment Profile<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#creating-the-deployment-profile" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>My goal is to get a Windows 11 device to the point it could be purchased from the manufacturer, sent to a new employee, then the employee can use their corporate login credentials to sign in and set up the laptop. The configuration should take care of all setup and installs and leave as little as possible to the user.</p>
<p>I went to Intune > Devices > Enrollment > Windows > Deployment Profiles > Create Profile</p>
<p>I gave the following settings to create the profile:</p>
<ul>
<li><strong>Name</strong>: Employee New Device</li>
<li><strong>Description</strong>: Windows 11 Employee Config</li>
<li><strong>Deployment Mode</strong>: User-Driven</li>
<li><strong>Joint to Microsoft Entra ID as</strong>: Microsoft Entra Joined</li>
<li><strong>Apply a device name template</strong>: Yes - <code>%SERIAL%-W</code></li>
<li><strong>Add Groups</strong>: All-Registered-Autopilot</li>
</ul>
<p>Summary of the Out-of-box experience (OOBE) settings</p>
<p><img src="../Intune-Lab/attachments/2.-Enrolling-Devices-3.png" width="auto" height="auto" alt/></p>
<h1 id="creating-an-enrollment-status-page-esp">Creating an Enrollment Status Page (ESP)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#creating-an-enrollment-status-page-esp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Next I needed to create an Enrollment Status Page to prevent the user from affecting the device setup and also provide them visibility into the setup status.</p>
<p>To access the ESP settings I went to Intune > Devices > Enrollment > Windows > Enrollment Status Page > Create</p>
<p>I gave it a name to match the Configuration Profile and set <strong>Show app and profile configuration progress</strong> to Yes and left all other settings as default on this page. I also assigned it to apply to the All-Windows-11 group.</p>
<p>Summary of ESP Settings below:</p>
<p><img src="../Intune-Lab/attachments/2.-Enrolling-Devices-4.png" width="auto" height="auto" alt/></p>
<p>The following settings are important here to make sure apps we install during setup finish before the computer is released to the user:</p>
<ul>
<li><strong>Block device use until all apps and profiles are installed</strong>: Yes</li>
<li><strong>Block device use until required apps are installed if they are assigned to the user/device</strong>: All</li>
</ul>
<h1 id="testing-out-of-box-experience-oobe">Testing Out-of-box experience (OOBE)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#testing-out-of-box-experience-oobe" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>With the command prompt still open on the Windows VM, I ran the command below to shutdown the device and set it back to OOBE mode.</p>
<pre><code>%SystemRoot%\System32\Sysprep\Sysprep.exe /oobe /shutdown
</code></pre>
<p>Once it turned back on I noticed the setup was different. It was now asking for a Microsoft Work/School account immediately. I chose one of the accounts from my organization at random and used their email address and password to login.</p>
<p>I noticed there were a few things I did not like about the OOBE setup. It asked the user to change their password as soon as they logged in. This may have been due to this being the first time they have ever logged in, or it could be set by Autopilot. I will need to look into this.</p>
<p>I also noticed it pushed the user into setting up a Windows Hello pin and then used that for login. I would instead prefer the user to have to use a domain user and password for login.</p>
<p>Lastly, I noticed it asked if the user wanted Microsoft 365 Copilot added to taskbar. I do not want my users to have this, or the question asking about it so I want to look into how to remove it.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="toc desktop-only"><button type="button" id="toc" class aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content" class><ul class="overflow"><li class="depth-0"><a href="#getting-the-hardware-hash" data-for="getting-the-hardware-hash">Getting the Hardware Hash</a></li><li class="depth-0"><a href="#creating-autopilot-device-group" data-for="creating-autopilot-device-group">Creating Autopilot Device Group</a></li><li class="depth-0"><a href="#creating-the-deployment-profile" data-for="creating-the-deployment-profile">Creating The Deployment Profile</a></li><li class="depth-0"><a href="#creating-an-enrollment-status-page-esp" data-for="creating-an-enrollment-status-page-esp">Creating an Enrollment Status Page (ESP)</a></li><li class="depth-0"><a href="#testing-out-of-box-experience-oobe" data-for="testing-out-of-box-experience-oobe">Testing Out-of-box experience (OOBE)</a></li></ul></div></div><div class="recent-notes desktop-only"><h3>Recent Notes</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Intune-Lab/6.-Securing-Devices" class="internal">6. Securing Devices</a></h3></div><p class="meta">Sep 26, 2025</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Intune-Lab/5.-Creating-Update-Rings" class="internal">5. Creating Update Rings</a></h3></div><p class="meta">Sep 26, 2025</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../" class="internal">üè° Home</a></h3></div><p class="meta">Sep 26, 2025</p><ul class="tags"></ul></div></li></ul></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="../Intune-Lab/4.-Installing-Apps" class="internal">4. Installing Apps</a></li><li><a href="../" class="internal">üè° Home</a></li></ul></div></div><footer class><ul><li><a href="https://github.com/mbusbee505">GitHub</a></li><li><a href="mailto:busbeetech@gmail.com">Email</a></li><li><a href="https://x.com/mbusbee505">Twitter</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../postscript.js" type="module"></script></html>