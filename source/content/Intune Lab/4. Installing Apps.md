
I wanted to test a few commonly used apps that also showcase the different methods of installing apps with Intune. I decided on the following:

- Line-of-business (LOB) - Zoom Workplace
- Win32 App - Google Chrome
- Microsoft Store app - GlobalProtect VPN
- Microsoft 365 Apps for Windows 11 - Microsoft Office

It looks like I will also need to add these to the Enrollment Status Page blocking so the user will not have access to the desktop until these are installed.

# Line-of-business (LOB) - Zoom Workplace

To create a LOB app you basically just need to find the .msi version of the app's installer and load it into Intune. Just go to `Intune > Apps > All apps > Create > App type > Line-of-business app`.

![[4. Installing Apps-1.png]]

Next it will ask to upload the file you can select it from your computer locally after downloading it from the internet or wherever else.

![[4. Installing Apps-2.png]]

In my case I went to [Zoom's Downloads for IT Admins](https://zoom.us/download/admin), selected the Download (ARM64), and downloaded it to my computer. I then went back to Intune and selected this file for the upload.

![[4. Installing Apps-3.png]]

> Keep in mind I only chose ARM due to the VM used for testing. In another environment you would want to consider the architecture and OS requirements for your app/device compatibility.

Luckily for me the Intune LOB App Wizard pre-populated a lot of the information to set up the app including the Name and Description. It labeled it as (ARM64) so if I needed to also provision the AMD64 version it would be easy to tell them apart.

For the Command-line arguments section I added the following:

```
/qn /norestart
```

This will prevent the device from restarting after the Zoom install is complete. 

I also needed to set the App install context to `Device` so that it automatically installs it during OOBE setup. If you keep it as the default `User` it will only install it after the user logs in, and it is only available for that user on the machine. I found it made more sense to keep it device-wide.

On the Assignments page I chose the `All-Windows-11` group to receive this install. This is where I could consider separating app availability by group membership but for now I will allow it on all Windows 11 devices.

![[4. Installing Apps-4.png]]
# Win32 App - Google Chrome

If the app developer does not provide an MSI version of the installer and you are forced to use an EXE or some form of script, you can wrap it in a Win32 App to make it usable within Intune. This can be done by using Microsoft's [Content-Prep-Tool](https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool) which is a Windows only tool for creating Win32 Apps. 

Since I had to use Windows, I downloaded the tool on my Windows machine, calling the file "Win32Prep" and created the following file structure:

```

C:/
├─ Source/
│  ├─ Chrome/
│  │  ├─ ChromeSetup.exe
├─ Tools/
│  ├─ Win32Prep/
│  │  ├─ IntuneWinAppUtil.exe
├─ Win32Output/
```

I then used the following command in a Windows machine to turn the Google Chrome:

```
C:\Tools\Win32Prep\IntuneWinAppUtil.exe `
  -c "C:\Source\Chrome" `
  -s "ChromeSetup.exe" `
  -o "C:\Win32Output"
```

Once this process completes you should see a `ChromeSetup.intunewin` file in the Win32Oput folder. Next is uploading this to Intune and creating an App for it.

Back in Intune I went to `Intune > Apps > All Apps > Create > App Type > Windows app (Win32)` and when it asked for the file I gave it the .intunewin I just made. I gave it the name Google Chrome (ARM64) to be consistent with the Zoom App.

I then entered the following settings:

- **Install command**: `ChromeSetup.exe /silent /install`
- **Uninstall command**: `"%ProgramFiles%\Google\Chrome\Application\chrome.exe" --uninstall --system-level --force-uninstall`
- **Allow available uninstall**: No
- **Install Behavior**: System
- **Device restart behavior**: No specific action

This will make sure Chrome installs for all users, the users are not allowed to uninstall the app, and the app will not restart the device after installation.

On the Requirements page I selected the following:

- **Check operating system architecture**: Yes - Install on ARM64 system
- **Minimum operating system**: Windows 11 21H2

This ensures this app can only install on ARM64 devices with any version of Windows 11. Since this is a fairly small app install I did not make any hardware requirements. 

Detection Rule settings:

- **Rule type**: File
- **Path**: C:\Program Files\Google\Chrome\
- **File or folder**: chrome.exe
- **Detection Method**: File or folder exists

For Assignments I selected this app be required for the All-Windows-11 group to be available for all Windows-11 users.

With all of that in place I hit Create and let Intune build the app for me and everything seemed good to go.

# Microsoft Store app - GlobalProtect VPN

To create a Microsoft Store app you just need to go to `Intune > Apps > All Apps > Create > App type > Microsoft Store app (new)` and searched for "GlobalProtect" in the search bar.

![[4. Installing Apps-5.png]]

When I selected this it auto-populated most of the information for me in the App Information settings. I did however change the Install behavior to `system` to ensure this would apply to all users on the device.

On the next page I assigned this to be required for the All-Windows-11 group then hit Create to let Intune build this for me. 



# Microsoft 365 Apps for Windows 11 - Microsoft Office


# Tweaking Enrollment Status Page

